# 学生信息管理系统方案设计

## 1. 总体目标
- 基于纯 C 语言实现，使用结构体 + 顺序表（数组）存储学生数据，支持增删改查与排序统计。
- 面向命令行交互，保持代码可移植、易读、易扩展。
- 数据以内存为主，提供可选的文件持久化（文本/CSV）读写。

## 2. 功能需求
1) 新增学生：录入学号（唯一）、姓名、性别、年龄、专业/班级、联系方式、成绩（可含多科目）。
2) 查询学生：按学号精确查找；按姓名模糊查找；支持列表分页展示。
3) 修改学生：基于学号定位，更新任意字段。
4) 删除学生：按学号删除，并保持数组紧凑。
5) 排序与统计：按学号、姓名、成绩升/降序；计算平均分、最高分、最低分、及格率。
6) 文件读写（可选）：启动时从文件加载，退出时写回；支持手动导入/导出。
7) 数据校验与提示：对唯一性、范围、空值做校验，友好提示错误。
8) 退出与数据保存：选择保存或放弃修改。

## 3. 数据结构设计
```c
#define MAX_STUDENTS 200
#define MAX_NAME_LEN 32
#define MAX_MAJOR_LEN 32
#define MAX_PHONE_LEN 16
#define MAX_SUBJECTS 8

typedef struct {
	char subject[MAX_NAME_LEN];
	float score;  // 0-100
} ScoreItem;

typedef struct {
	char id[16];                 // 学号，唯一
	char name[MAX_NAME_LEN];
	char gender[8];              // 简单存储 "M"/"F" 或 "男"/"女"
	int age;                     // 15-60
	char major[MAX_MAJOR_LEN];   // 专业/班级
	char phone[MAX_PHONE_LEN];
	ScoreItem scores[MAX_SUBJECTS];
	int score_count;             // 有效科目数
} Student;

typedef struct {
	Student data[MAX_STUDENTS];
	int size; // 当前学生数量
} StudentList;
```
设计要点：
- 使用顺序表保持简单；删除后用末尾元素填补或整体左移。
- 学号使用字符串便于包含前导零；所有字符串统一长度上限。
- 成绩用科目+分数对，便于扩展多科目；`score_count` 控制有效长度。

## 4. 模块与函数设计
- 初始化与持久化：`load_from_file(StudentList*, const char*)`，`save_to_file(...)`。
- 输入校验：`is_unique_id(...)`，`valid_age(...)`，`valid_score(...)`。
- CRUD：`add_student(...)`，`find_by_id(...)`，`find_by_name(...)`，`update_student(...)`，`remove_student(...)`。
- 排序：`sort_by_id(...)`，`sort_by_name(...)`，`sort_by_score(...)`（选择主科或平均分）。
- 统计：`calc_avg(...)`，`calc_min(...)`，`calc_max(...)`，`calc_pass_rate(...)`。
- 展示：`print_student(const Student*)`，`print_table(const StudentList*, int page, int page_size)`。
- 交互层：菜单循环 `main_menu()`，分发到各功能。

## 5. 核心流程（示意）
1) 程序启动：读取文件（若存在）填充 `StudentList`；若失败则初始化空表。
2) 菜单循环：显示功能选项，读取用户输入，分支执行。
3) 增删改查：操作 `StudentList`；所有输入先校验再落表。
4) 排序/统计：在内存中就地排序或生成派生指标再输出。
5) 退出：询问是否保存，选择保存则写入文件。

## 6. 文件与格式约定
- 默认数据文件：`data/students.csv`（逗号分隔，UTF-8）。
- 行格式示例：`2024001,张三,男,20,计算机-1班,13800000000,math:95;cs:88`
- 读取时解析科目-分数字串；写入时按相同格式序列化。

## 7. 边界与异常处理
- 容量上限：超过 `MAX_STUDENTS` 提示并拒绝新增。
- 唯一性：新增/修改时检测学号冲突。
- 输入范围：年龄、成绩超界或字段为空则拒绝并提示。
- 文件 IO：读写异常打印原因，不影响内存数据；保存失败提示用户。
- 排序/统计空表：提示“暂无数据”，避免越界访问。

## 8. 交互设计（CLI）
- 菜单示例：
  - 1 新增  2 查询  3 修改  4 删除  5 排序  6 统计  7 导入/导出  0 退出
- 输入引导：逐字段提示；错误时提示原因并重输。
- 列表输出：表头对齐、分页显示（如每页 10 条，支持上一页/下一页）。

## 9. 测试要点
- 学号唯一性：重复新增/修改触发冲突。
- 边界容量：接近/达到 `MAX_STUDENTS` 行为正确。
- 排序稳定性：多条件、空表、单元素、已排序、逆序。
- 成绩统计：空成绩、单科、多科、含 0/满分。
- 文件读写：正常、文件不存在、权限不足、格式异常行。

## 10. 未来扩展
- 将顺序表替换为动态数组或链表，支持更大数据量。
- 增加登录与权限（教师/管理员）。
- 增加 JSON/二进制存储，或网络接口（简易 TCP/HTTP）。
- 引入单元测试（如 CMocka）保障回归质量。
